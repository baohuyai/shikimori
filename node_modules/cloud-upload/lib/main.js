/**
 * This is the main class, the entry point to cloud-upload.
 */
class CloudUpload {
  constructor() {}

  middleware(req, _res, next, err) {
    try {
      if (req.file) {
        req.file.uploadToGoogleDrive = this.uploadToGoogleDrive;
        req.file.uploadToGCS = this.uploadToGCS;
        req.file.uploadToS3 = this.uploadToS3;
      } else if (req.files.length) {
        console.log(req.files);
        req.files.map((file) => {
          file.uploadToGoogleDrive = this.uploadToGoogleDrive;
          file.uploadToGCS = this.uploadToGCS;
          file.uploadToS3 = this.uploadToS3;
          return file;
        });
        console.log(req.files);
      } else {
        // Section - Files are not uploaded
        // Throw Error / Ignore / Skip
      }
      next();
    } catch (err) {
      next(err);
    }
  }
}

module.exports = CloudUpload;
